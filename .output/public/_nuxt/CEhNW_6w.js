import{r as u,f as D,e as K,A as c,h as x}from"./D6E0p70F.js";const f=new Map,F=(y={})=>{const{minLoadTime:p=500,loadFunction:d=null,onPageReady:s=null,cacheKey:P=null,enableCache:h=!0}=y,m=x(),a=u(!0),t=u(!0),v=u(!1),o=u(!1),r=u(""),i=()=>P||m.path,L=()=>{if(!h)return null;const e=i();return f.get(e)},C=e=>{if(!h)return;const l=i();f.set(l,{data:e,timestamp:Date.now()})},g=async()=>{try{const e=L();if(e)return a.value=!1,t.value=!1,v.value=!0,o.value=!1,r.value="",s&&typeof s=="function"&&s(e.data),e.data;a.value=!0,t.value=!0,o.value=!1,r.value="";let l=Promise.resolve(),n=null;d&&typeof d=="function"&&(l=d());const[T]=await Promise.all([l,new Promise(b=>setTimeout(b,p))]);return n=T,n&&C(n),a.value=!1,t.value=!1,v.value=!0,s&&typeof s=="function"&&s(n),n}catch(e){throw console.error("页面加载失败:",e),o.value=!0,r.value=e.message||"页面加载失败",a.value=!1,t.value=!1,e}},w=async()=>{const e=i();f.delete(e),await g()},k=e=>{t.value=e,a.value=e},R=e=>{o.value=!0,r.value=e,a.value=!1,t.value=!1},E=()=>{o.value=!1,r.value=""},M=()=>{const e=i();f.delete(e)};return D(()=>m.path,(e,l)=>{console.log("路由变化:",l,"->",e)}),K(()=>{g()}),{isPageLoading:c(a),isDataLoading:c(t),isPageReady:c(v),hasError:c(o),errorMessage:c(r),startLoading:g,reloadPage:w,setLoading:k,setError:R,clearError:E,clearCache:M}},j={fast:{minLoadTime:300,enableCache:!0},standard:{minLoadTime:500,enableCache:!0}};export{j as p,F as u};
