import{a2 as n}from"./-_uPjKn3.js";const i=n("user",{state:()=>({isLoggedIn:!1,user:null,token:null}),getters:{userAvatar:e=>{var r,o,s;return(r=e.user)!=null&&r.avatar?e.user.avatar:(((o=e.user)==null?void 0:o.nickname)||((s=e.user)==null?void 0:s.username)||"U").charAt(0).toUpperCase()},userDisplayName:e=>{var t,r;return((t=e.user)==null?void 0:t.nickname)||((r=e.user)==null?void 0:r.username)||"用户"},hasAvatarImage:e=>{var t;return!!((t=e.user)!=null&&t.avatar)}},actions:{initializeAuth(){if(typeof window<"u")try{const e=localStorage.getItem("authToken"),t=localStorage.getItem("userInfo");e&&t?(this.token=e,this.user=JSON.parse(t),this.isLoggedIn=!0):this.clearAuth()}catch(e){console.error("初始化用户状态失败:",e),this.clearAuth()}},setAuth(e,t){this.token=e,this.user=t,this.isLoggedIn=!0,typeof window<"u"&&(localStorage.setItem("authToken",e),localStorage.setItem("userInfo",JSON.stringify(t)))},updateUser(e){this.user=e,typeof window<"u"&&localStorage.setItem("userInfo",JSON.stringify(e))},clearAuth(){this.token=null,this.user=null,this.isLoggedIn=!1,typeof window<"u"&&(localStorage.removeItem("authToken"),localStorage.removeItem("userInfo"))},logout(){this.clearAuth(),typeof window<"u"&&(window.location.href="/auth/login")}}});export{i as u};
