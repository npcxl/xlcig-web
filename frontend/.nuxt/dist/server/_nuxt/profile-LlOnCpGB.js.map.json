{"file":"profile-LlOnCpGB.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_push","_parent","_ssrRenderAttr","_ssrInterpolate","_ssrRenderList","_ssrRenderClass","_ssrIncludeBooleanAttr"],"sources":["../../../../pages/profile.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-black relative overflow-hidden\">\r\n    <!-- 背景装饰效果 -->\r\n    <div class=\"fixed inset-0 pointer-events-none\">\r\n      <div class=\"absolute top-20 left-20 w-96 h-96 bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-full filter blur-3xl animate-pulse\"></div>\r\n      <div class=\"absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full filter blur-3xl animate-pulse delay-1000\"></div>\r\n    </div>\r\n\r\n    <!-- 导航栏 -->\r\n    <nav class=\"relative z-10\">\r\n      <div class=\"container mx-auto px-6 py-6\">\r\n        <div class=\"glass-card-dark rounded-2xl p-6 border border-cyan-500/30 shadow-2xl shadow-cyan-500/20\">\r\n          <div class=\"flex items-center justify-between\">\r\n            <div class=\"flex items-center space-x-6\">\r\n              <!-- Logo -->\r\n              <AppLogo size=\"medium\" :show-decorations=\"false\" />\r\n              <div class=\"h-6 w-px bg-gray-600\"></div>\r\n              \r\n              <!-- 帅气的返回按钮 -->\r\n              <button \r\n                @click=\"goBack\" \r\n                class=\"group relative inline-flex items-center px-6 py-3 rounded-xl font-medium transition-all duration-300 transform hover:-translate-y-1 hover:scale-105 overflow-hidden\"\r\n              >\r\n                <!-- 按钮背景渐变和光效 -->\r\n                <div class=\"absolute inset-0 bg-gradient-to-r from-cyan-600/20 via-blue-600/20 to-purple-600/20 rounded-xl transition-all duration-300 group-hover:from-cyan-500/30 group-hover:via-blue-500/30 group-hover:to-purple-500/30\"></div>\r\n                <div class=\"absolute inset-0 border-2 border-cyan-500/30 rounded-xl transition-all duration-300 group-hover:border-cyan-400/60 group-hover:shadow-lg group-hover:shadow-cyan-400/25\"></div>\r\n                \r\n                <!-- 动态粒子效果 -->\r\n                <div class=\"absolute inset-0 rounded-xl overflow-hidden\">\r\n                  <div class=\"absolute w-2 h-2 bg-cyan-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 animate-ping\" style=\"top: 20%; left: 15%; animation-delay: 0s;\"></div>\r\n                  <div class=\"absolute w-1 h-1 bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 animate-ping\" style=\"top: 60%; left: 80%; animation-delay: 0.2s;\"></div>\r\n                  <div class=\"absolute w-1.5 h-1.5 bg-purple-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 animate-ping\" style=\"top: 80%; left: 30%; animation-delay: 0.4s;\"></div>\r\n                </div>\r\n                \r\n                <!-- 左侧箭头图标 -->\r\n                <div class=\"relative flex items-center\">\r\n                  <div class=\"w-10 h-10 rounded-full bg-gradient-to-r from-cyan-500/20 to-blue-500/20 flex items-center justify-center mr-3 transition-all duration-300 group-hover:from-cyan-400/40 group-hover:to-blue-400/40 group-hover:scale-110\">\r\n                    <i class=\"bi bi-arrow-left text-cyan-400 text-lg transition-all duration-300 group-hover:text-white group-hover:-translate-x-1\"></i>\r\n                  </div>\r\n                  \r\n                  <!-- 文字和副标题 -->\r\n                  <div class=\"text-left\">\r\n                    <div class=\"text-white text-sm font-semibold transition-all duration-300 group-hover:text-cyan-100\">返回</div>\r\n                    <div class=\"text-gray-400 text-xs transition-all duration-300 group-hover:text-cyan-300\">Back</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <!-- 右侧装饰线条 -->\r\n                <div class=\"absolute right-3 top-1/2 transform -translate-y-1/2\">\r\n                  <div class=\"flex flex-col space-y-1 opacity-60 group-hover:opacity-100 transition-opacity duration-300\">\r\n                    <div class=\"w-6 h-0.5 bg-gradient-to-r from-cyan-400 to-transparent rounded-full transition-all duration-300 group-hover:w-8\"></div>\r\n                    <div class=\"w-4 h-0.5 bg-gradient-to-r from-blue-400 to-transparent rounded-full transition-all duration-300 group-hover:w-6 delay-75\"></div>\r\n                    <div class=\"w-2 h-0.5 bg-gradient-to-r from-purple-400 to-transparent rounded-full transition-all duration-300 group-hover:w-4 delay-150\"></div>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            </div>\r\n            <nav class=\"text-sm text-gray-400\">\r\n              <NuxtLink to=\"/\" class=\"hover:text-cyan-400 transition-colors duration-200\">首页</NuxtLink>\r\n              <i class=\"bi bi-chevron-right mx-2 text-cyan-400\"></i>\r\n              <span class=\"text-white font-medium\">个人中心</span>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n\r\n    <div class=\"relative z-10 py-8\">\r\n      <div class=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <!-- 页面标题 -->\r\n        <div class=\"mb-8 animate-fade-in-up\">\r\n          <div class=\"glass-card-dark rounded-2xl p-8 border border-cyan-500/30 shadow-2xl shadow-cyan-500/20\">\r\n            <h1 class=\"text-4xl font-bold text-white mb-3 flex items-center gap-3\">\r\n              <i class=\"bi bi-person-circle text-cyan-400 text-3xl animate-bounce-gentle\"></i>\r\n              个人中心\r\n            </h1>\r\n            <p class=\"text-gray-300 text-lg\">管理您的个人信息和账户设置</p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 用户信息卡片 -->\r\n        <div class=\"glass-card-dark rounded-2xl p-8 border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 mb-6 animate-fade-in-up animation-delay-200\">\r\n          <div class=\"flex items-center space-x-6\">\r\n            <!-- 头像 -->\r\n            <div class=\"relative group\">\r\n              <div class=\"w-24 h-24 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center text-white text-2xl font-bold shadow-lg shadow-cyan-500/20 group-hover:shadow-cyan-500/40 transition-all duration-300 transform group-hover:scale-105 overflow-hidden\">\r\n                <img \r\n                  v-if=\"userInfo?.avatar\" \r\n                  :src=\"userInfo.avatar\" \r\n                  :alt=\"(userInfo?.nickname || userInfo?.username || 'U') + '的头像'\"\r\n                  class=\"w-full h-full object-cover\"\r\n                  @error=\"handleAvatarError\"\r\n                />\r\n                <span v-else>{{ (userInfo?.nickname || userInfo?.username || 'U').charAt(0).toUpperCase() }}</span>\r\n              </div>\r\n              <button \r\n                @click=\"showAvatarModal = true\"\r\n                class=\"absolute bottom-0 right-0 bg-cyan-500 text-white rounded-full p-2 hover:bg-cyan-400 transition-all duration-200 transform hover:scale-110 shadow-lg shadow-cyan-500/20\"\r\n              >\r\n                <i class=\"bi bi-camera text-sm\"></i>\r\n              </button>\r\n            </div>\r\n            \r\n            <!-- 用户基本信息 -->\r\n            <div class=\"flex-1\">\r\n              <h2 class=\"text-2xl font-bold text-white mb-2\">{{ userInfo?.nickname || userInfo?.username || '加载中...' }}</h2>\r\n              <p class=\"text-gray-300 mb-1\">{{ userInfo?.email || '' }}</p>\r\n              <p v-if=\"userInfo?.nickname && userInfo?.username\" class=\"text-sm text-gray-400\">用户名: {{ userInfo.username }}</p>\r\n              <div class=\"flex items-center space-x-4 mt-3\">\r\n                <span class=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium\"\r\n                      :class=\"roleStyles[userInfo?.role || 'user']\">\r\n                  {{ roleLabels[userInfo?.role || 'user'] }}\r\n                </span>\r\n                <span class=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium\"\r\n                      :class=\"statusStyles[userInfo?.status || 'active']\">\r\n                  {{ statusLabels[userInfo?.status || 'active'] }}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            \r\n            <!-- 快捷操作 -->\r\n            <div class=\"flex flex-col space-y-3\">\r\n              <button @click=\"activeTab = 'edit'\" class=\"btn-premium-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1\">\r\n                <i class=\"bi bi-pencil-square mr-2\"></i>\r\n                编辑资料\r\n              </button>\r\n              <button @click=\"activeTab = 'password'\" class=\"btn-outline-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1\">\r\n                <i class=\"bi bi-shield-lock mr-2\"></i>\r\n                修改密码\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 标签页导航 -->\r\n        <div class=\"glass-card-dark rounded-2xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 overflow-hidden animate-fade-in-up animation-delay-400\">\r\n          <div class=\"border-b border-gray-700/50\">\r\n            <nav class=\"flex space-x-8\">\r\n              <button \r\n                v-for=\"tab in tabs\" \r\n                :key=\"tab.key\"\r\n                @click=\"activeTab = tab.key\"\r\n                :class=\"[\r\n                  'py-4 px-6 text-sm font-medium border-b-2 transition-all duration-300 flex items-center gap-2',\r\n                  activeTab === tab.key \r\n                    ? 'border-cyan-500 text-cyan-400 bg-cyan-500/10' \r\n                    : 'border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600'\r\n                ]\"\r\n              >\r\n                <i :class=\"tab.icon\"></i>\r\n                {{ tab.label }}\r\n              </button>\r\n            </nav>\r\n          </div>\r\n\r\n          <!-- 标签页内容 -->\r\n          <div class=\"p-8\">\r\n            <!-- 基本信息 -->\r\n            <div v-if=\"activeTab === 'info'\" class=\"space-y-6 animate-fade-in\">\r\n              <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div class=\"glass-morphism-dark rounded-lg p-4 border border-gray-700/50 hover:border-cyan-500/30 transition-all duration-300\">\r\n                  <label class=\"block text-sm font-medium text-cyan-400 mb-2\">用户名</label>\r\n                  <p class=\"text-white text-lg\">{{ userInfo?.username || '-' }}</p>\r\n                </div>\r\n                <div class=\"glass-morphism-dark rounded-lg p-4 border border-gray-700/50 hover:border-cyan-500/30 transition-all duration-300\">\r\n                  <label class=\"block text-sm font-medium text-cyan-400 mb-2\">昵称</label>\r\n                  <p class=\"text-white text-lg\">{{ userInfo?.nickname || '-' }}</p>\r\n                </div>\r\n                <div class=\"glass-morphism-dark rounded-lg p-4 border border-gray-700/50 hover:border-cyan-500/30 transition-all duration-300\">\r\n                  <label class=\"block text-sm font-medium text-cyan-400 mb-2\">邮箱</label>\r\n                  <p class=\"text-white text-lg\">{{ userInfo?.email || '-' }}</p>\r\n                </div>\r\n                <div class=\"glass-morphism-dark rounded-lg p-4 border border-gray-700/50 hover:border-cyan-500/30 transition-all duration-300\">\r\n                  <label class=\"block text-sm font-medium text-cyan-400 mb-2\">手机号</label>\r\n                  <p class=\"text-white text-lg\">{{ userInfo?.phone || '-' }}</p>\r\n                </div>\r\n                <div class=\"glass-morphism-dark rounded-lg p-4 border border-gray-700/50 hover:border-cyan-500/30 transition-all duration-300 md:col-span-2\">\r\n                  <label class=\"block text-sm font-medium text-cyan-400 mb-2\">注册时间</label>\r\n                  <p class=\"text-white text-lg\">{{ formatDate(userInfo?.created_at) || '-' }}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 编辑资料 -->\r\n            <div v-if=\"activeTab === 'edit'\" class=\"space-y-6 animate-fade-in\">\r\n              <form @submit.prevent=\"updateProfile\">\r\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div class=\"space-y-2\">\r\n                    <label for=\"username\" class=\"block text-sm font-medium text-cyan-400\">用户名</label>\r\n                    <input \r\n                      id=\"username\"\r\n                      v-model=\"editForm.username\" \r\n                      type=\"text\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请输入用户名\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"space-y-2\">\r\n                    <label for=\"nickname\" class=\"block text-sm font-medium text-cyan-400\">昵称</label>\r\n                    <input \r\n                      id=\"nickname\"\r\n                      v-model=\"editForm.nickname\" \r\n                      type=\"text\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请输入昵称\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"space-y-2 md:col-span-2\">\r\n                    <label for=\"phone\" class=\"block text-sm font-medium text-cyan-400\">手机号</label>\r\n                    <input \r\n                      id=\"phone\"\r\n                      v-model=\"editForm.phone\" \r\n                      type=\"tel\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请输入手机号\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                \r\n                <div class=\"flex justify-end space-x-4 mt-8\">\r\n                  <button type=\"button\" @click=\"resetEditForm\" class=\"btn-outline-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1\">\r\n                    <i class=\"bi bi-arrow-clockwise mr-2\"></i>\r\n                    重置\r\n                  </button>\r\n                  <button type=\"submit\" :disabled=\"updating\" class=\"btn-premium-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed\">\r\n                    <span v-if=\"updating\" class=\"loading loading-spinner loading-sm mr-2\"></span>\r\n                    <i v-else class=\"bi bi-check-circle mr-2\"></i>\r\n                    {{ updating ? '保存中...' : '保存修改' }}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n\r\n            <!-- 修改密码 -->\r\n            <div v-if=\"activeTab === 'password'\" class=\"space-y-6 animate-fade-in\">\r\n              <form @submit.prevent=\"changePassword\">\r\n                <div class=\"max-w-md space-y-6\">\r\n                  <div class=\"space-y-2\">\r\n                    <label for=\"currentPassword\" class=\"block text-sm font-medium text-cyan-400\">当前密码</label>\r\n                    <input \r\n                      id=\"currentPassword\"\r\n                      v-model=\"passwordForm.currentPassword\" \r\n                      type=\"password\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请输入当前密码\"\r\n                      required\r\n                    />\r\n                  </div>\r\n                  <div class=\"space-y-2\">\r\n                    <label for=\"newPassword\" class=\"block text-sm font-medium text-cyan-400\">新密码</label>\r\n                    <input \r\n                      id=\"newPassword\"\r\n                      v-model=\"passwordForm.newPassword\" \r\n                      type=\"password\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请输入新密码（至少6位）\"\r\n                      required\r\n                      minlength=\"6\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"space-y-2\">\r\n                    <label for=\"confirmPassword\" class=\"block text-sm font-medium text-cyan-400\">确认新密码</label>\r\n                    <input \r\n                      id=\"confirmPassword\"\r\n                      v-model=\"passwordForm.confirmPassword\" \r\n                      type=\"password\" \r\n                      class=\"input-dark w-full\"\r\n                      placeholder=\"请再次输入新密码\"\r\n                      required\r\n                    />\r\n                  </div>\r\n                </div>\r\n                \r\n                <div class=\"flex justify-end space-x-4 mt-8\">\r\n                  <button type=\"button\" @click=\"resetPasswordForm\" class=\"btn-outline-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1\">\r\n                    <i class=\"bi bi-arrow-clockwise mr-2\"></i>\r\n                    重置\r\n                  </button>\r\n                  <button type=\"submit\" :disabled=\"changingPassword\" class=\"btn-premium-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed\">\r\n                    <span v-if=\"changingPassword\" class=\"loading loading-spinner loading-sm mr-2\"></span>\r\n                    <i v-else class=\"bi bi-shield-check mr-2\"></i>\r\n                    {{ changingPassword ? '修改中...' : '修改密码' }}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 头像上传弹窗 -->\r\n    <div v-if=\"showAvatarModal\" class=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in\">\r\n      <div class=\"glass-card-dark rounded-2xl p-6 max-w-md w-full mx-4 border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 animate-scale-in\">\r\n        <h3 class=\"text-xl font-semibold text-white mb-6 flex items-center gap-3\">\r\n          <i class=\"bi bi-camera text-cyan-400\"></i>\r\n          上传头像\r\n        </h3>\r\n        \r\n        <div class=\"space-y-6\">\r\n          <!-- 文件选择区域 -->\r\n          <div class=\"flex justify-center\">\r\n            <div class=\"relative\">\r\n              <input \r\n                id=\"avatar-input\"\r\n                type=\"file\" \r\n                accept=\"image/*\" \r\n                @change=\"onFileChange\"\r\n                class=\"hidden\"\r\n              />\r\n              \r\n              <!-- 预览区域 -->\r\n              <div \r\n                @click=\"triggerFileInput\"\r\n                class=\"w-32 h-32 border-2 border-dashed border-cyan-500/30 rounded-lg flex items-center justify-center hover:border-cyan-400/50 transition-colors duration-300 cursor-pointer overflow-hidden\"\r\n              >\r\n                <img \r\n                  v-if=\"avatarPreview\" \r\n                  :src=\"avatarPreview\" \r\n                  alt=\"头像预览\"\r\n                  class=\"w-full h-full object-cover\"\r\n                />\r\n                <div v-else class=\"text-center\">\r\n                  <i class=\"bi bi-cloud-upload text-3xl text-cyan-400 mb-2 block\"></i>\r\n                  <span class=\"text-sm text-gray-400\">点击选择图片</span>\r\n                </div>\r\n              </div>\r\n              \r\n              <!-- 重新选择按钮 -->\r\n              <button \r\n                v-if=\"avatarPreview\"\r\n                @click=\"triggerFileInput\"\r\n                class=\"absolute top-0 right-0 bg-cyan-500 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-cyan-400 transition-colors duration-200\"\r\n              >\r\n                <i class=\"bi bi-pencil text-xs\"></i>\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- 文件信息 -->\r\n          <div v-if=\"selectedFile\" class=\"text-center\">\r\n            <p class=\"text-sm text-gray-400\">{{ selectedFile.name }}</p>\r\n            <p class=\"text-xs text-gray-500\">{{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>\r\n          </div>\r\n          \r\n          <!-- 提示信息 -->\r\n          <p class=\"text-center text-gray-400 text-sm\">\r\n            支持 JPG、PNG、GIF、WebP 格式<br>\r\n            文件大小不超过 2MB\r\n          </p>\r\n          \r\n          <!-- 操作按钮 -->\r\n          <div class=\"flex justify-end space-x-4\">\r\n            <button \r\n              @click=\"closeAvatarModal\" \r\n              class=\"btn-outline-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1\"\r\n            >\r\n              <i class=\"bi bi-x-circle mr-2\"></i>\r\n              取消\r\n            </button>\r\n            <button \r\n              @click=\"uploadAvatar\"\r\n              :disabled=\"!selectedFile || uploadingAvatar\"\r\n              class=\"btn-premium-dark px-6 py-3 rounded-lg font-medium transition-all duration-300 transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              <span v-if=\"uploadingAvatar\" class=\"loading loading-spinner loading-sm mr-2\"></span>\r\n              <i v-else class=\"bi bi-check-circle mr-2\"></i>\r\n              {{ uploadingAvatar ? '上传中...' : '确定上传' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { api } from '../utils/api'\r\nimport type { User, UserUpdateInput, PasswordChangeInput } from '../utils/api'\r\nimport { createDiscreteApi } from 'naive-ui'\r\nimport { useUserStore } from '../stores/user'\r\n\r\n// 使用Pinia store\r\nconst userStore = useUserStore()\r\n\r\n// 创建临时的消息API\r\nconst { message } = createDiscreteApi(['message'])\r\n\r\n// 临时消息函数\r\nconst success = (content: string) => {\r\n  message.success(content, { duration: 3000 })\r\n}\r\n\r\nconst error = (content: string) => {\r\n  message.error(content, { duration: 4000 })\r\n}\r\n\r\n// 响应式数据\r\nconst userInfo = ref<User | null>(null)\r\nconst loading = ref(true)\r\nconst updating = ref(false)\r\nconst changingPassword = ref(false)\r\nconst showAvatarModal = ref(false)\r\nconst uploadingAvatar = ref(false)\r\nconst avatarPreview = ref<string | null>(null)\r\nconst selectedFile = ref<File | null>(null)\r\nconst activeTab = ref('info')\r\n\r\n// 标签页配置\r\nconst tabs = [\r\n  { key: 'info', label: '基本信息', icon: 'bi bi-person' },\r\n  { key: 'edit', label: '编辑资料', icon: 'bi bi-pencil-square' },\r\n  { key: 'password', label: '修改密码', icon: 'bi bi-shield-lock' }\r\n]\r\n\r\n// 编辑表单\r\nconst editForm = reactive<UserUpdateInput>({\r\n  username: '',\r\n  nickname: '',\r\n  phone: ''\r\n})\r\n\r\n// 密码修改表单\r\nconst passwordForm = reactive<PasswordChangeInput & { confirmPassword: string }>({\r\n  currentPassword: '',\r\n  newPassword: '',\r\n  confirmPassword: ''\r\n})\r\n\r\n// 样式配置\r\nconst roleStyles = {\r\n  user: 'bg-blue-500/20 text-blue-300 border border-blue-500/30',\r\n  merchant: 'bg-purple-500/20 text-purple-300 border border-purple-500/30',\r\n  admin: 'bg-red-500/20 text-red-300 border border-red-500/30'\r\n}\r\n\r\nconst roleLabels = {\r\n  user: '普通用户',\r\n  merchant: '商家',\r\n  admin: '管理员'\r\n}\r\n\r\nconst statusStyles = {\r\n  active: 'bg-green-500/20 text-green-300 border border-green-500/30',\r\n  inactive: 'bg-gray-500/20 text-gray-300 border border-gray-500/30',\r\n  banned: 'bg-red-500/20 text-red-300 border border-red-500/30'\r\n}\r\n\r\nconst statusLabels = {\r\n  active: '正常',\r\n  inactive: '未激活',\r\n  banned: '已封禁'\r\n}\r\n\r\n// 返回功能\r\nconst goBack = () => {\r\n  window.history.back()\r\n}\r\n\r\n// 获取用户信息\r\nconst fetchUserInfo = async () => {\r\n  try {\r\n    loading.value = true\r\n    const response = await api.auth.getProfile()\r\n    if (response.data) {\r\n      userInfo.value = response.data\r\n      // 初始化编辑表单\r\n      editForm.username = response.data.username\r\n      editForm.nickname = response.data.nickname || ''\r\n      editForm.phone = response.data.phone || ''\r\n    }\r\n  } catch (error) {\r\n    console.error('获取用户信息失败:', error)\r\n    window.location.href = '/auth/login'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 更新个人信息\r\nconst updateProfile = async () => {\r\n  try {\r\n    updating.value = true\r\n    const response = await api.auth.updateProfile(editForm)\r\n    if (response.data) {\r\n      // 更新本地用户信息\r\n      userInfo.value = response.data\r\n      \r\n      // 更新Pinia store中的用户信息\r\n      userStore.updateUser(response.data)\r\n      \r\n      // 显示成功提示\r\n      success('个人信息更新成功！')\r\n      activeTab.value = 'info'\r\n    }\r\n  } catch (error: any) {\r\n    console.error('更新个人信息失败:', error)\r\n    error(error.message || '更新失败，请重试')\r\n  } finally {\r\n    updating.value = false\r\n  }\r\n}\r\n\r\n// 修改密码\r\nconst changePassword = async () => {\r\n  if (passwordForm.newPassword !== passwordForm.confirmPassword) {\r\n    error('两次输入的新密码不一致')\r\n    return\r\n  }\r\n\r\n  try {\r\n    changingPassword.value = true\r\n    await api.auth.changePassword({\r\n      currentPassword: passwordForm.currentPassword,\r\n      newPassword: passwordForm.newPassword\r\n    })\r\n    \r\n    success('密码修改成功，请重新登录')\r\n    // 清除本地存储并跳转到登录页\r\n    localStorage.removeItem('authToken')\r\n    localStorage.removeItem('userInfo')\r\n    window.location.href = '/auth/login'\r\n  } catch (error: any) {\r\n    console.error('修改密码失败:', error)\r\n    error(error.message || '修改密码失败，请重试')\r\n  } finally {\r\n    changingPassword.value = false\r\n  }\r\n}\r\n\r\n// 重置编辑表单\r\nconst resetEditForm = () => {\r\n  if (userInfo.value) {\r\n    editForm.username = userInfo.value.username\r\n    editForm.nickname = userInfo.value.nickname || ''\r\n    editForm.phone = userInfo.value.phone || ''\r\n  }\r\n}\r\n\r\n// 重置密码表单\r\nconst resetPasswordForm = () => {\r\n  passwordForm.currentPassword = ''\r\n  passwordForm.newPassword = ''\r\n  passwordForm.confirmPassword = ''\r\n}\r\n\r\n// 格式化日期\r\nconst formatDate = (dateString?: string) => {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString('zh-CN')\r\n}\r\n\r\n// 头像上传相关方法\r\nconst onFileChange = (event: Event) => {\r\n  const target = event.target as HTMLInputElement\r\n  const file = target.files?.[0]\r\n  \r\n  if (!file) return\r\n\r\n  // 验证文件\r\n  const validation = api.upload.validateImageFile(file)\r\n  if (!validation.valid) {\r\n    error(validation.message!)\r\n    return\r\n  }\r\n\r\n  selectedFile.value = file\r\n  // 创建预览URL\r\n  avatarPreview.value = api.upload.getFilePreviewUrl(file)\r\n}\r\n\r\nconst uploadAvatar = async () => {\r\n  if (!selectedFile.value) {\r\n    error('请选择要上传的头像')\r\n    return\r\n  }\r\n\r\n  try {\r\n    uploadingAvatar.value = true\r\n    const response = await api.upload.uploadAvatar(selectedFile.value)\r\n    \r\n    if (response.success && response.data) {\r\n      // 更新本地用户信息\r\n      userInfo.value = response.data.user\r\n      \r\n      // 更新Pinia store中的用户信息（这会自动同步到localStorage和所有页面）\r\n      userStore.updateUser(response.data.user)\r\n      \r\n      success('头像更新成功！')\r\n      closeAvatarModal()\r\n    }\r\n  } catch (err: any) {\r\n    console.error('头像上传失败:', err)\r\n    error(err.message || '头像上传失败，请重试')\r\n  } finally {\r\n    uploadingAvatar.value = false\r\n  }\r\n}\r\n\r\nconst closeAvatarModal = () => {\r\n  showAvatarModal.value = false\r\n  selectedFile.value = null\r\n  \r\n  // 释放预览URL\r\n  if (avatarPreview.value) {\r\n    api.upload.releaseFilePreviewUrl(avatarPreview.value)\r\n    avatarPreview.value = null\r\n  }\r\n}\r\n\r\nconst triggerFileInput = () => {\r\n  const fileInput = document.getElementById('avatar-input') as HTMLInputElement\r\n  fileInput?.click()\r\n}\r\n\r\nconst handleAvatarError = () => {\r\n  // 处理头像加载失败的情况\r\n  console.error('头像加载失败')\r\n}\r\n\r\n// 页面挂载时获取用户信息\r\nonMounted(() => {\r\n  fetchUserInfo()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* 深色主题按钮样式 */\r\n.btn-premium-dark {\r\n  background: linear-gradient(135deg, #00f5ff 0%, #0080ff 100%);\r\n  color: white;\r\n  box-shadow: 0 4px 15px rgba(0, 245, 255, 0.4);\r\n}\r\n\r\n.btn-premium-dark:hover {\r\n  box-shadow: 0 6px 20px rgba(0, 245, 255, 0.6);\r\n}\r\n\r\n.btn-outline-dark {\r\n  border: 2px solid rgba(100, 116, 139, 0.3);\r\n  color: #cbd5e1;\r\n  background: rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.btn-outline-dark:hover {\r\n  border-color: rgba(0, 245, 255, 0.5);\r\n  color: #00f5ff;\r\n  background: rgba(0, 245, 255, 0.1);\r\n}\r\n\r\n/* 深色主题输入框样式 */\r\n.input-dark {\r\n  background: rgba(0, 0, 0, 0.3);\r\n  border: 2px solid rgba(100, 116, 139, 0.3);\r\n  color: white;\r\n  padding: 0.75rem 1rem;\r\n  border-radius: 0.5rem;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.input-dark:focus {\r\n  outline: none;\r\n  border-color: #00f5ff;\r\n  box-shadow: 0 0 0 3px rgba(0, 245, 255, 0.2);\r\n}\r\n\r\n.input-dark::placeholder {\r\n  color: #64748b;\r\n}\r\n\r\n/* 加载动画 */\r\n.loading {\r\n  display: inline-block;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n.loading-spinner {\r\n  border: 2px solid transparent;\r\n  border-top: 2px solid currentColor;\r\n  border-radius: 50%;\r\n}\r\n\r\n.loading-sm {\r\n  width: 1rem;\r\n  height: 1rem;\r\n}\r\n\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n/* 自定义动画 */\r\n@keyframes fade-in-up {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(30px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n@keyframes fade-in {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n@keyframes scale-in {\r\n  from {\r\n    opacity: 0;\r\n    transform: scale(0.9);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: scale(1);\r\n  }\r\n}\r\n\r\n@keyframes bounce-gentle {\r\n  0%, 20%, 50%, 80%, 100% {\r\n    transform: translateY(0);\r\n  }\r\n  40% {\r\n    transform: translateY(-5px);\r\n  }\r\n  60% {\r\n    transform: translateY(-3px);\r\n  }\r\n}\r\n\r\n.animate-fade-in-up {\r\n  animation: fade-in-up 0.6s ease-out;\r\n}\r\n\r\n.animate-fade-in {\r\n  animation: fade-in 0.4s ease-out;\r\n}\r\n\r\n.animate-scale-in {\r\n  animation: scale-in 0.3s ease-out;\r\n}\r\n\r\n.animate-bounce-gentle {\r\n  animation: bounce-gentle 2s infinite;\r\n}\r\n\r\n.animation-delay-200 {\r\n  animation-delay: 0.2s;\r\n}\r\n\r\n.animation-delay-400 {\r\n  animation-delay: 0.4s;\r\n}\r\n\r\n/* 玻璃拟态效果 */\r\n.glass-card-dark {\r\n  background: rgba(0, 0, 0, 0.7);\r\n  backdrop-filter: blur(20px);\r\n  border: 1px solid rgba(255, 255, 255, 0.1);\r\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.glass-morphism-dark {\r\n  background: rgba(0, 0, 0, 0.4);\r\n  backdrop-filter: blur(10px);\r\n  border: 1px solid rgba(255, 255, 255, 0.1);\r\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);\r\n}\r\n</style> "],"version":3}